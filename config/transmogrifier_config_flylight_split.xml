<?xml version="1.0"?>

<transmogrifierConfiguration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                     xsi:noNamespaceSchemaLocation="transmogrifier_config.xsd">

    <global minimumVersion="2.8.6" frameSizePercentage="95"/>

    <project name="Fly Light: Pilot Split Images" default="true">

        <inputFileFilter patternString=".+\.(jpeg|jpg|lsm|tiff)" />

        <outputDirectory fileModeReadOnly="true">
            <path path="[\\arch.janelia.priv|/archive]/rubin/data1/rubinlab/aRnim/IMAGE-DATA/Split-Gal4/org-import/" />
            <renameFieldValue fieldDisplayName="Dissection Date" prefix="D"/>
        </outputDirectory>

        <plugins>
            <rowUpdater className="org.janelia.it.ims.tmog.plugin.dataFile.DataResourcePlugin">
                <property name="plugin.service-url" value="http://sage.int.janelia.org/flyboy-ws/project_crosses/withSerialNumberOrLabel?labelName=${Cross Label}&amp;serialNumber=${Serial Number}" />
                <property name="plugin.test-url" value="http://sage.int.janelia.org/flyboy-ws/project_crosses/withSerialNumberOrLabel?labelName=splitPilot-AJ-00001&amp;serialNumber=" />
                <property name="plugin.root-xpath" value="projectCross" />
                <property name="Line" value="name" />
                <property name="Cross Label" value="specialCrossLabel" />
                <property name="ParentA" value="parent1StockName" />
                <property name="ParentB" value="parent2StockName" />
            </rowUpdater>
            <rowListener className="org.janelia.it.ims.tmog.plugin.imagedb.CrossLineCreationPlugin">
                <property name="db.config.key" value="sage"/>
                <property name="line" value="${Line}"/>
                <property name="line-lab" value="flylight"/>
                <property name="parent-a-line" value="${ParentA}"/>
                <property name="parent-a-line-lab" value="rubin"/>
                <property name="parent-b-line" value="${ParentB}"/>
                <property name="parent-b-line-lab" value="rubin"/>
            </rowListener>
            <rowListener className="org.janelia.it.ims.tmog.plugin.imagedb.ImageDataPlugin">
                <property name="db.config.key" value="sage"/>
                <property name="lab" value="$STATIC:flylight"/>
                <property name="family" value="$STATIC:flylight_split"/>
                <property name="line" value="${Line}"/>
                <property name="dissection_date" value="${Dissection Date}"/>
                <property name="cross_label" value="${Cross Label}"/>
                <property name="area" value="Area$MAP:brain=Brain|VNC=Ventral Nerve Cord"/>
                <property name="base_path" value="$STATIC:/archive/rubin/data1/rubinlab/aRnim/IMAGE-DATA/Split-Gal4/org-import/"/>
            </rowListener>
        </plugins>

        <dataFields>

            <text displayName="Line" required="true"
                  displayWidth="200"
                  editable="false"
                  pattern=".+-x-.+">
            </text>

            <separator value="@"/>

            <date displayName="Dissection Date" required="true"
                  datePattern="yyMMdd">
                <sourceFileDateDefault pattern=".*D(\d{6}).*"
                                       matchType="path"
                                       fromDatePattern="yyMMdd"
                                       toDatePattern="yyMMdd"/>                
            </date>

            <separator value="@"/>

            <text displayName="Cross Label"
                  pattern="[^@]+"
                  required="true"/>

            <separator value="@"/>

            <validValueList displayName="Area" required="false"
                            autoComplete="true">
                <validValue value="brain"/>
                <validValue value="VNC"/>
            </validValueList>

            <separator value="@"/>

            <text displayName="Image Name" required="false"
                  copyable="false">
                <sourceFileDefault pattern="(.+?)\.(jpeg|jpg|lsm|tiff)"
                                   patternGroupNumber="1"/>
            </text>

            <separator value="@"/>
            <runTime datePattern="yyyyMMddHHmmssSSS"/>

            <fileExtension/>

            <pluginData displayName="ParentA" markedForTask="false"/>
            <pluginData displayName="ParentB" markedForTask="false"/>

        </dataFields>

    </project>

</transmogrifierConfiguration>
