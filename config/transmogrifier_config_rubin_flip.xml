<?xml version="1.0"?>

<transmogrifierConfiguration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                     xsi:noNamespaceSchemaLocation="transmogrifier_config.xsd">

    <global minimumVersion="2.4.5" frameSizePercentage="95"/>

    <project name="Rubin Lab: Flip (GMR_*)" default="true">

        <inputFileSorter sortAlgorithm="LNumber" />

        <!-- TODO: would aRnim prefer to use line based directories? -->
        <outputDirectory basePath="\\dm10.isln.janelia.org\rubindata\flipStacks"
                         derivedFromEarliestModifiedFile="true"/>

        <plugins>
            <!--<rowValidator className="org.janelia.it.chacrm.ChacrmEventManager" />-->
            <rowListener className="org.janelia.it.ims.tmog.plugin.imagedb.ImageDataPlugin">
                <property name="db.config.key" value="nighthawk"/>
                <property name="family" value="family"/>
                <property name="line" value="GMR_${Plate}${Well}_${Vector ID}_${Landing Site}"/>
                <property name="created_by" value="Imager"/>
                <property name="experiment" value="Experiment"/>
                <property name="slide" value="Slide"/>
                <property name="heat_shock_minutes" value="Heat Shock Minutes"/>
                <property name="temperature" value="Temperature"/>
                <property name="protocol" value="Protocol"/>
                <property name="stain:field-group" value="Stain"/>
                <property name="notes" value="Notes"/>
            </rowListener>
        </plugins>

        <dataFields>
            <separator value="GMR_"/>
            <number displayName="Plate" required="true"
                    minimumValue="1" maximumValue="999">
                <sourceFileDefault pattern="flip\d-(\d++)[A-E].*"/>
            </number>
            <well displayName="Well" required="true" formFactor="96"/>
            <separator value="_"/>
            <cvTermList displayName="Vector ID" required="true"
                        serviceUrl="http://sage.int.janelia.org/sage-ws/cvs/rubin_crm_vector"
                        displayNamePrefixedForValues="true">
            </cvTermList>
            <separator value="_"/>
            <cvTermList displayName="Landing Site" required="true"
                        serviceUrl="http://sage.int.janelia.org/sage-ws/cvs/rubin_crm_landing_site"
                        displayNamePrefixedForValues="true">
                <staticDefault value="01"/>
            </cvTermList>
            <separator value="_"/>
            <!-- TODO: should this be UAS Reporter? -->
            <validValueList displayName="Reporter Construct" required="true">
                <validValue displayName="01: ??" value="01"/>
                <validValue displayName="02: ??" value="02"/>
            </validValueList>
            <text displayName="L Number" required="true"
                  pattern="^\d++$" minimumLength="1" maximumLength="3"
                  prefix="_L" padFormat="30">
                <sourceFileDefault pattern=".*L(\d++).lsm"/>
                <staticDefault value="0"/>
            </text>
            <separator value="_"/>
            <runTime datePattern="yyyyMMddHHmmssSSS"/>
            <separator value=".lsm"/>

            <!--
             These values are collected for the nighthawk database but are not
             included as components of the file name (markedForTask="false").
             -->
            <number displayName="Experiment"
                    required="false"
                    minimumValue="1"
                    maximumValue="100"
                    markedForTask="false">
                <sourceFileDefault pattern="flip(\d).*"/>
            </number>

            <number displayName="Slide"
                    required="false"
                    minimumValue="1"
                    maximumValue="100"
                    markedForTask="false">
                <sourceFileDefault pattern="flip\d\.(\d).*"/>
            </number>

            <decimal displayName="Heat Shock Minutes"
                     required="false"
                     minimumValue="0"
                     markedForTask="false"/>

            <number displayName="Temperature"
                    required="false"
                    minimumValue="0"
                    maximumValue="99"
                    markedForTask="false"/>

            <text displayName="Protocol"
                  required="false"
                  markedForTask="false"/>

            <fieldGroup displayName="Stain">

                <validValueList displayName="Primary Antibody"
                                required="false"
                                markedForTask="false">
                    <validValue value="anti-a"/>
                    <validValue value="anti-b"/>
                </validValueList>

                <validValueList displayName="Primary Dilution"
                                required="false"
                                markedForTask="false">
                    <validValue value="1:100"/>
                    <validValue value="1:1000"/>
                </validValueList>

                <validValueList displayName="Secondary Antibody"
                                required="false"
                                markedForTask="false">
                    <validValue value="anti-a"/>
                    <validValue value="anti-b"/>
                </validValueList>

                <validValueList displayName="Secondary Dilution"
                                required="false"
                                markedForTask="false">
                    <validValue value="1:100"/>
                    <validValue value="1:1000"/>
                </validValueList>

            </fieldGroup>

            <text displayName="Notes"
                  required="false"
                  markedForTask="false"/>

            <validValueList displayName="Imager"
                            required="true"
                            markedForTask="false">
                <validValue value="Aljoscha Nern"/>
                <validValue value="Amanda Cavallaro"/>
                <validValue value="Arnim Jenett"/>
                <validValue value="Chris Zugates"/>
                <validValue value="Christine Murphy"/>
                <validValue value="Donald Hall"/>
                <validValue value="Teri Ngo"/>
            </validValueList>

            <static name="family" value="rubin_flip" markedForTask="false"/>
        </dataFields>

    </project>

</transmogrifierConfiguration>